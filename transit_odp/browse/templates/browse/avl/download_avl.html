{% extends 'browse/base.html' %}

{% load static %}
{% load i18n %}
{% load breadcrumbs %}

{% block title_tag %}
  {% trans 'All bus location data' %}
{% endblock %}

{% block breadcrumb.content %}
  {{ block.super }}
  {% breadcrumb_url 'Download all data' 'downloads' host hosts.data %}
  {% breadcrumb 'All bus location data' %}
{% endblock %}

{% block heading.title.text %}{% trans 'All bus location data' %}{% endblock %}

{% block secondary.title %}
  <h3 class="govuk-heading-l">{% trans 'Download file' %}</h3>
{% endblock %}

{% block heading.subtitle %}
  <p class="govuk-body">
    {% blocktrans %}
      Click the link below to download a snapshot of all live bus locations at a point in time.
      This link will update every 5 seconds.
      This data will be provided in a SIRI-VM format within a compressed Zip file.
    {% endblocktrans %}
  </p>
  <p class="govuk-body govuk-!-margin-bottom-0">
    {% if show_bulk_archive_url %}
      <a class="govuk-link" href="{% url 'downloads-avl-bulk' host hosts.data %}"
         onClick="addGATagEvent()">
        {% trans 'Download all bus location data  ' %}
      </a>
    {% else %}
      {% blocktrans %}
        Bulk download is not yet available. Please check back later.
      {% endblocktrans %}
    {% endif %}
  </p>

  <p class="govuk-body govuk-!-margin-top-6">
    {% blocktrans %}
      Download bus location data in GTFS-RT format.

      You can download all bus location data from England as of today by clicking
      the link below.

      Note: The zip archive should be created every 5 seconds with all AVL data in GTFS format.
    {% endblocktrans %}
  </p>
  <p class="govuk-body govuk-!-margin-bottom-0">
    {% if show_bulk_archive_url %}
      <a class="govuk-link" href="{% url 'download-gtfsrt-bulk' host hosts.data %}"
         onClick="addGAGTFSRTDownloadEvent()">
        {% trans 'Download all bus location data in GTFS format' %}
      </a>
    {% else %}
      {% blocktrans %}
        Bulk download is not yet available. Please check back later.
      {% endblocktrans %}
    {% endif %}
  </p>
{% endblock %}

{% block heading.secondary %}
  <div class="govuk-grid-column-one-third">
    <h3 class="govuk-heading-m">
      {% trans 'What you need to know' %}
    </h3>
    <p class="govuk-body">
      <a class="govuk-link" href="{% url 'guidance:support-developer' host hosts.data %}">
        {% trans 'View developer documentation' %}
      </a>
    </p>
    <p class="govuk-body">
      <a class="govuk-link" href="https://www.gov.uk/government/consultations/bus-services-act-2017-bus-open-data"
         target="_blank">
        {% trans 'Find out more about bus open data' %}
      </a>
    </p>
    <p class="govuk-body">
      <a class="govuk-link" href="{% url 'contact' host hosts.root %}">
        {% trans 'Contact us for technical issues' %}
      </a>
    </p>
    <p class="govuk-body">
      <a class="govuk-link" href="{% url 'download-catalogue' host hosts.data %}">
        {% trans 'Download data catalogue' %}
      </a>
    </p>
  </div>
{% endblock %}

{% block inner %}
  <div class="govuk-grid-row govuk-!-margin-top-9">
  </div>
{% endblock %}

{% block scripts %}
  {{ block.super }}
  <script>
    function addGATagEvent() {
      gtag('event', 'Download all event', {
        'event_category': 'link',
        'event_label': 'bulk download avl',
        'event_action': 'download'
      });
    };
    function addGAGTFSRTDownloadEvent() {
      var clickEvent = {
        'event_category': 'link',
        'event_label': 'bulk download avlgtfs',
        'event_action': 'download'
      }
      gtag('event', 'Download gtfs all event', clickEvent);
    }
  </script>
{% endblock %}
